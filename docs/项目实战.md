# 项目实战

meefood(我食)是一个基于物联网概念下的智能收货运营管理系统

![image-20240808151231606](https://shepi-1308499968.cos.ap-chengdu.myqcloud.com/img/image-20240808151231606.png)

## 角色与功能

* 管理员：查看订单，统计报表
* 运维人员：投放设备，拆除设备，维修设备
* 运营人员：补货
* 合作商：提供点位，坐收渔翁之利
* 消费者：在小程序下单商品

## 库表设计

![image-20240808152741537](https://shepi-1308499968.cos.ap-chengdu.myqcloud.com/img/image-20240808152741537.png)

## 初识AI

### AIGC

* AI Generated Content：AI领域的一个应用分支，专注于AI技术自动生成内容

### 提示工程

* 提示就是我们对大模型提问的问题
* 提示工程也称为上下文提示，设计优化和输入文本来引导AI模型生成预期的输出

#### promt的组成

* 角色
* 指示
* 上下文
* 例子
* 输入
* 输出

## 点位管理

### 需求说明

* 业务场景：在成都的高流量商业区和居民区与潜在合作商洽谈，确定定位不熟智能售货机，提供便捷的购买服务
* 点位管理功能主要涉及三个模块

![image-20240808170335302](https://shepi-1308499968.cos.ap-chengdu.myqcloud.com/img/image-20240808170335302.png)

### 表设计

* 区域表：主键id，区域名称、~~备注说明~~
* 合作商表：主键id、合作商名称、联系人、联系电话、分成比例、账号、密码
* 点位表：主键id、点位名称、区域外键、商圈字典、合作商外键、详细地址

![image-20240808175110950](https://shepi-1308499968.cos.ap-chengdu.myqcloud.com/img/image-20240808175110950.png)

* 关系字段：`region_id`、`partner_id`
* 数据字典：`bussiness_type`

### 生成基础代码

* 创建目录菜单
* 添加数据字典
* 配置代码生成信息
* 下载代码，并导入项目

### 区域管理代码改造

* 查看详情，显示当前区域下所有的点位列表
* 查询区域列表的时候，同时显示每个区域的点位数

**解决方案**

① 同步存储：在区域表中有点位字段，点位发生变化时，同步区域的点位数

② **关联查询**：编写关联查询语句，在mapper层封装

**实现步骤**

* 关联查询编写sql语句
* 创建`ReagionVO`增加关键字段`nodeCount`
* 在`RegionMapper`和`xml`文件中添加查询`Vo`方法和sql
* 在`RegionService`接口和实现类中添加查询Vo方法
* 修改`RegionCountroller`查询方法
* 修改前端页面视图



# BUG处理

## 1.MySQL执行出现错误

```sql
<select id="selectRegionVoList" resultType="com.dkd.manage.domain.vo.RegionVo">
       select r.*, count(n.id) as node_count from tb_region r left join tb_node n on r.id = n.region_id
        <where>
            <if test="name != null  and name != ''"> and r.name like concat('%', #{name}, '%')</if>
        </where>
        group by r.id
</select>
```

`group by r.id`要放在`where`子句的后面，要严格按照语法顺序编写 sql

